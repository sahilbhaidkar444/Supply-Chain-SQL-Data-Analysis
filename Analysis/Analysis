-- Basic Level Analysis Questions :
-- 1. How many products does the company sell?
SELECT COUNT(*) AS num_products FROM products;

-- 2. What are the names of the products and their corresponding SKUs?
SELECT pname, sku
FROM products;

-- 3. What is the price of each product?
SELECT pname, price
FROM products;

-- 4. How much inventory does the company have for each product?
SELECT p.pname, i.curr_quantity
FROM products p
JOIN inventory i ON p.pid = i.pid;

-- 5. What is the reorder point for each product?
SELECT pname, reorder_point
FROM products p
JOIN inventory i ON p.pid = i.pid;

-- 6. How many vendors does the company have?
SELECT COUNT(*) FROM vendors;

-- 7. 
SELECT vname, address, contact
FROM vendors;

-- 8. How many orders has the company received?
SELECT COUNT(*) as order_count FROM orders;

-- 9. What is the total quantity of products ordered by each vendor?
SELECT vname, SUM(quantity) AS total_quantity
FROM orders o
JOIN items i ON o.order_id = i.order_id
JOIN vendors v ON o.vendor_id = v.vid
GROUP BY vname;

-- Intermediate Level Analysis Questions:
-- 1. Which product has the highest price and what is the price?
SELECT pname, price 
FROM products 
ORDER BY price DESC 
LIMIT 1;

-- 2. What is the average price of all the products?
SELECT AVG(price) AS avg_price
FROM products;

-- 3. Which product has the highest revenue?
SELECT p.pname, SUM(i.quantity * i.unit_price) AS revenue
FROM products p
INNER JOIN items i ON p.pid = i.product_id
GROUP BY p.pid
ORDER BY revenue DESC
LIMIT 1;

-- 4. What is the total revenue generated from all the orders?
SELECT SUM(quantity * unit_price) AS total_revenue
FROM orders
JOIN items ON orders.order_id = items.order_id;

-- 5. What is the revenue generated by each vendor?
SELECT v.vname AS vendor_name, SUM(i.quantity * i.unit_price) AS revenue
FROM orders o
JOIN items i ON o.order_id = i.order_id
JOIN vendors v ON o.vendor_id = v.vid
GROUP BY v.vname;

-- 6. What is the total quantity of each product sold?
SELECT p.pname, SUM(i.quantity) as total_quantity_sold
FROM items i
JOIN products p ON i.product_id = p.pid
GROUP BY i.product_id
ORDER BY total_quantity_sold DESC;

-- 7. Which product has the maximum quantity sold?
SELECT p.pname AS Product_Name, SUM(i.quantity) AS Total_Quantity_Sold
FROM items i
JOIN products p ON i.product_id = p.pid
GROUP BY p.pname
ORDER BY Total_Quantity_Sold DESC
LIMIT 3;

-- 8. What is the average quantity of each product sold per order?
SELECT i.product_id, AVG(i.quantity) AS avg_quantity
FROM items i
JOIN orders o ON i.order_id = o.order_id
GROUP BY i.product_id;

-- 9. What is the average unit price of each product sold per order?
SELECT products.pname, AVG(items.unit_price) AS avg_unit_price
FROM items
JOIN products ON items.product_id = products.pid
GROUP BY items.product_id;
